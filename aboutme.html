<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environment Auditor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .break-all { word-break: break-all; }
    </style>
</head>
<body class="min-h-screen bg-slate-50 text-slate-900 p-4 md:p-8">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <header class="mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4">
            <div>
                <h1 class="text-3xl font-bold text-slate-800 tracking-tight flex items-center gap-2">
                    <i data-lucide="activity" class="text-blue-600"></i>
                    Environment Auditor
                </h1>
                <p class="text-slate-500 mt-1">Detailed hardware and browser capability inspection tool.</p>
            </div>
            <button 
                onclick="refreshData()"
                class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all shadow-md active:scale-95"
            >
                Refresh Data
            </button>
        </header>

        <!-- Loading State -->
        <div id="loading" class="hidden flex items-center justify-center h-64">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
        </div>

        <!-- Content Grid -->
        <div id="content-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Sections will be injected here -->
        </div>

        <footer class="mt-12 text-center text-slate-400 text-xs border-t border-slate-200 pt-6">
            <p>This application does not transmit or store any data. It simply probes your browser's APIs for inspection.</p>
            <p class="mt-1 italic">Note: Some hardware data (like Memory) may be rounded to protect privacy (Anti-Fingerprinting).</p>
        </footer>
    </div>

    <script>
        const loadingEl = document.getElementById('loading');
        const gridEl = document.getElementById('content-grid');

        const getBatteryInfo = async () => {
            if ('getBattery' in navigator) {
                try {
                    const battery = await navigator.getBattery();
                    return {
                        level: `${Math.round(battery.level * 100)}%`,
                        charging: battery.charging ? 'Yes' : 'No',
                        chargingTime: battery.chargingTime === Infinity ? 'N/A' : `${battery.chargingTime}s`,
                        dischargingTime: battery.dischargingTime === Infinity ? 'N/A' : `${battery.dischargingTime}s`,
                    };
                } catch (e) { return null; }
            }
            return null;
        };

        const getStorageInfo = async () => {
            if (navigator.storage && navigator.storage.estimate) {
                try {
                    const estimate = await navigator.storage.estimate();
                    return {
                        quota: `${(estimate.quota / (1024 * 1024 * 1024)).toFixed(2)} GB`,
                        usage: `${(estimate.usage / (1024 * 1024)).toFixed(2)} MB`,
                    };
                } catch (e) { return null; }
            }
            return null;
        };

        const getNetworkInfo = () => {
            const conn = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            if (conn) {
                return {
                    type: conn.effectiveType || 'N/A',
                    downlink: `${conn.downlink} Mbps`,
                    rtt: `${conn.rtt} ms`,
                    saveData: conn.saveData ? 'Enabled' : 'Disabled',
                };
            }
            return null;
        };

        const getWebGLExtensions = () => {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (!gl) return null;
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                return {
                    vendor: debugInfo ? gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) : 'Unknown',
                    renderer: debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : 'Unknown',
                    version: gl.getParameter(gl.VERSION),
                    shadingLanguage: gl.getParameter(gl.SHADING_LANGUAGE_VERSION),
                };
            } catch (e) { return null; }
        };

        async function refreshData() {
            loadingEl.classList.remove('hidden');
            gridEl.classList.add('hidden');
            gridEl.innerHTML = '';

            const battery = await getBatteryInfo();
            const storage = await getStorageInfo();
            const network = getNetworkInfo();
            const webgl = getWebGLExtensions();

            const sections = [
                {
                    title: "Browser & Engine",
                    icon: "globe",
                    iconColor: "text-blue-500",
                    items: [
                        { label: "User Agent", value: navigator.userAgent },
                        { label: "Vendor", value: navigator.vendor },
                        { label: "Language", value: navigator.language },
                        { label: "Cookies Enabled", value: navigator.cookieEnabled ? "Yes" : "No", status: navigator.cookieEnabled },
                        { label: "Online Status", value: navigator.onLine ? "Connected" : "Disconnected", status: navigator.onLine },
                    ]
                },
                {
                    title: "Display & Graphics",
                    icon: "monitor",
                    iconColor: "text-purple-500",
                    items: [
                        { label: "Screen Resolution", value: `${window.screen.width} x ${window.screen.height}` },
                        { label: "Viewport Size", value: `${window.innerWidth} x ${window.innerHeight}` },
                        { label: "Pixel Ratio", value: window.devicePixelRatio },
                        { label: "Color Depth", value: `${window.screen.colorDepth}-bit` },
                        { label: "GPU Vendor", value: webgl?.vendor || 'N/A' },
                        { label: "GPU Renderer", value: webgl?.renderer || 'N/A' },
                    ]
                },
                {
                    title: "Hardware Resources",
                    icon: "cpu",
                    iconColor: "text-red-500",
                    items: [
                        { label: "Logical Processors", value: navigator.hardwareConcurrency || 'Unknown' },
                        { label: "Device Memory", value: navigator.deviceMemory ? `${navigator.deviceMemory} GB (Approx)` : 'Unknown' },
                        { label: "Max Touch Points", value: navigator.maxTouchPoints },
                        { label: "Platform", value: navigator.platform },
                    ]
                },
                {
                    title: "System Context",
                    icon: "clock",
                    iconColor: "text-emerald-500",
                    items: [
                        { label: "Timezone", value: Intl.DateTimeFormat().resolvedOptions().timeZone },
                        { label: "Locale", value: Intl.DateTimeFormat().resolvedOptions().locale },
                        { label: "Dark Mode Preferred", value: window.matchMedia('(prefers-color-scheme: dark)').matches ? 'Yes' : 'No' },
                    ]
                }
            ];

            if (battery) {
                sections.push({
                    title: "Power Status",
                    icon: "battery",
                    iconColor: "text-yellow-500",
                    items: [
                        { label: "Battery Level", value: battery.level },
                        { label: "Is Charging", value: battery.charging },
                        { label: "Charging Time", value: battery.chargingTime },
                    ]
                });
            }

            if (network) {
                sections.push({
                    title: "Network Condition",
                    icon: "wifi",
                    iconColor: "text-indigo-500",
                    items: [
                        { label: "Effective Type", value: network.type },
                        { label: "Downlink", value: network.downlink },
                        { label: "Round Trip Time", value: network.rtt },
                    ]
                });
            }

            if (storage) {
                sections.push({
                    title: "Storage Quota",
                    icon: "hard-drive",
                    iconColor: "text-orange-500",
                    items: [
                        { label: "Estimated Quota", value: storage.quota },
                        { label: "Current Usage", value: storage.usage },
                    ]
                });
            }

            sections.forEach(section => {
                const card = document.createElement('div');
                card.className = "bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col";
                
                let itemsHtml = section.items.map(item => `
                    <div class="group">
                        <div class="flex justify-between items-start mb-1">
                            <span class="text-xs font-bold uppercase tracking-wider text-slate-400 group-hover:text-slate-600 transition-colors">
                                ${item.label}
                            </span>
                            ${item.status !== undefined ? (item.status ? '<i data-lucide="check-circle-2" class="w-3.5 h-3.5 text-emerald-500"></i>' : '<i data-lucide="x-circle" class="w-3.5 h-3.5 text-red-500"></i>') : ''}
                        </div>
                        <div class="text-sm font-medium text-slate-800 break-all bg-slate-50/50 p-2 rounded border border-transparent group-hover:border-slate-100 group-hover:bg-slate-50 transition-all">
                            ${item.value}
                        </div>
                    </div>
                `).join('');

                card.innerHTML = `
                    <div class="bg-slate-50 px-5 py-4 border-b border-slate-200 flex items-center gap-3">
                        <i data-lucide="${section.icon}" class="w-5 h-5 ${section.iconColor}"></i>
                        <h2 class="font-semibold text-slate-700">${section.title}</h2>
                    </div>
                    <div class="p-5 flex-1 space-y-4">
                        ${itemsHtml}
                    </div>
                `;
                gridEl.appendChild(card);
            });

            lucide.createIcons();
            loadingEl.classList.add('hidden');
            gridEl.classList.remove('hidden');
        }

        window.onload = refreshData;
        window.onresize = refreshData;
    </script>
</body>
</html>
